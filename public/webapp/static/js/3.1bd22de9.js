webpackJsonp([3],{131:function(t,i,e){function s(t){e(339)}var a=e(0)(e(367),e(305),s,null,null);t.exports=a.exports},132:function(t,i,e){function s(t){e(324)}var a=e(0)(e(368),e(288),s,null,null);t.exports=a.exports},171:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAARCAYAAADHeGwwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAC/SURBVHjatNQxSgNBFIDhz8FGBS1s9CZ2UcFjpE6R1nOI5d7AUtPZeYZ0uygKIZBrpNmBsAzr7GbnHeD7i3lvTtbvcwXmEku8nRbAr/CJO1yHgvgfXkNB/B7bUBDfQCiJTxE4xH+7eAzcYIGzI/GHLh4Dz6iwwvmUeAxU2OEJHxmRbDwGfvCYGRmEHz5ynREZjHe3qC8yCk+taSpyOxaH1GdXt8hXG/nGxRi879CaFtsdg/93yQ1meEldaO7sBwAI4UROCMCv9AAAAABJRU5ErkJggg=="},194:function(t,i,e){i=t.exports=e(117)(!1),i.push([t.i,".address-card{color:#727998;padding-top:.5rem}.address-card-bd:active{background-color:#f2f2f2}.address-bottom{height:1.2rem;line-height:1.2rem}.address-l{width:0;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.address-r{width:60px;margin-left:10px;word-wrap:nowrap}",""])},209:function(t,i,e){i=t.exports=e(117)(!1),i.push([t.i,".address-icon-trash{background-image:url("+e(251)+");background-size:60%}",""])},212:function(t,i,e){i=t.exports=e(117)(!1),i.push([t.i,'.picker-panel{width:100%;height:9.85rem;position:absolute;bottom:0;background-color:#fff;overflow:hidden;-webkit-transition:all .3s;transition:all .3s;z-index:10;color:#14284f}.picker-panel[status="0"]{-webkit-transform:translateY(100%);transform:translateY(100%)}.picker-hd{height:1rem;line-height:1.3rem;color:#727998}.picker-tab-wrap:after{z-index:-1}.picker-tab{display:inline-block;border-bottom:2px solid transparent;margin-right:20px;height:.85rem;line-height:.75rem}.picker-tab-active{color:#d1af5d;border-bottom-color:#d1af5d}.picker-option{height:8rem;overflow-y:auto;padding-bottom:15px}.picker-option li{line-height:1.2rem}.picker-option-checked{color:#d1af5d}.picker-icon-check{display:inline-block;width:12px;height:9px;background-image:url('+e(171)+");background-repeat:no-repeat;background-size:100%;background-position:50%;margin-left:10px}.picker-panel .g-hair-bottom:after{bottom:1px}",""])},251:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAABl0lEQVRYhWMU0fD/zzCIAdNAO4AQGHUgpYCFVA0cHGwM9SXxDME+9gyC/DxE6fnw6QvDms0HGRq6FzL8/PmLtg5sqUhmiA93Z/j37z/YYmIAHw83Q0q0N8O/v/8YqtvnkmQfI6m5+P6Z5Qw83JwMdn55DNdvPyJKj6aaPMOhjRMZPn/5xqBkGkWSA0lOgyDHgQCxjgOrvfUQTPPycJFqHfYQ3LKkncHcWJNkwygBJ89eZ/CJqcQQHzS5mJERhzihNPj6+gYwLaoZQFUH7VnTC6ZdQorxqiM5F1ML6GsrE6Vu0EQxLjDqQErBqAMpBRQ5EFSggzC58sQAiooZQrUNNWqj4R3F9ACjDqQUjDqQUjDoHUhROQhqBeNqaBIjTwygyIHYmuikyBMDBn0UjzqQUkDQgR8/fwXTxnpqVLPU1EAdxWx8gGAmWbl+H0NanC/DjpVdlLsMDSxetYugGmYuEY0GfAqOnLzMwMfDxaCsKMXAwc5GFYeBxnRAjmvpW8zw998/vGpJHpuhNxj6mWSgwagDKQWD3oEAdWhq0ZdIx88AAAAASUVORK5CYII="},277:function(t,i,e){function s(t){e(342)}var a=e(0)(e(356),e(308),s,null,null);t.exports=a.exports},288:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"g-inner"},[e("top-nav",{attrs:{title:"地址管理"}}),t._v(" "),e("div",{staticClass:"g-holder g-pt g-pb"},[t._l(t.list,function(i,s){return e("div",{staticClass:"g-paper address-card mt10"},[e("div",{staticClass:"rel g-hair-bottom pb15 address-card-bd",on:{click:function(e){t.select(i)}}},[e("p",{staticClass:"g-color-1 mb10"},[e("span",{staticClass:"mr6"},[t._v(t._s(i.consignee_name))]),t._v(" "),e("span",[t._v(t._s(t._f("phoneNumber")(i.phone)))])]),t._v(" "),e("p",[t._v(t._s(i.addressDetail))])]),t._v(" "),e("div",{staticClass:"flex address-bottom"},[e("div",{staticClass:"address-l"},[e("label",{on:{click:function(e){t.setDefault(s,i.id)}}},[e("i",{staticClass:"g-checkbox vm",class:{checked:+i.is_default}}),t._v(" "),e("span",{staticClass:"vm"},[t._v(t._s(+i.is_default?"默认地址":"设为默认"))])])]),t._v(" "),e("div",{staticClass:"address-r tr",on:{click:function(e){t.edit(s,i.id)}}},[e("i",{staticClass:"i i-edit vm"}),t._v(" "),e("span",{staticClass:"vm"},[t._v("编辑")])]),t._v(" "),e("div",{staticClass:"address-r tr",on:{click:function(e){t.dele(s,i.id)}}},[e("i",{staticClass:"i i-trash vm"}),t._v(" "),e("span",{staticClass:"vm"},[t._v("删除")])])])])}),t._v(" "),e("router-link",{staticClass:"g-btn g-btn-touchable mt30",attrs:{tag:"div",to:"/aux/addressEdit"}},[e("span",{staticClass:"f24 vm lighter"},[t._v("+")]),t._v(" "),e("span",{staticClass:"vm"},[t._v("新建地址")])])],2)],1)},staticRenderFns:[]}},305:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"g-inner g-pt"},[e("top-nav",{attrs:{title:"编辑地址",iconClass:t.id?"address-icon-trash":""},on:{event:t.dele}}),t._v(" "),e("ul",{staticClass:"g-list"},[e("li",{staticClass:"g-hair-bottom"},[e("div",{staticClass:"g-form-list-l"},[t._v("收件人")]),t._v(" "),e("div",{staticClass:"g-form-list-r"},[t._v("\n        "+t._s(t.receiver)+"\n      ")])]),t._v(" "),e("li",{staticClass:"g-hair-bottom"},[e("div",{staticClass:"g-form-list-l"},[t._v("联系电话")]),t._v(" "),e("div",{staticClass:"g-form-list-r"},[t._v("\n        "+t._s(t.phone)+"\n      ")])]),t._v(" "),e("li",{staticClass:"g-hair-bottom",on:{click:t.showPicker}},[e("div",{staticClass:"g-form-list-l"},[t._v("所在地区")]),t._v(" "),3===t.region.length?e("div",{staticClass:"g-form-list-r"},t._l(t.region,function(i){return e("span",{staticClass:"mr4"},[t._v(t._s(i.name))])})):e("div",{staticClass:"g-form-list-r"},[t._v("请选择")]),t._v(" "),e("div",{staticClass:"g-form-list-angle"})]),t._v(" "),e("li",{class:{"g-hair-bottom":!t.initial}},[e("div",{staticClass:"g-form-list-l"},[t._v("详细地址")]),t._v(" "),e("div",{staticClass:"g-form-list-r"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.address,expression:"address",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请填写详细地址，不少于5个字"},domProps:{value:t.address},on:{input:function(i){i.target.composing||(t.address=i.target.value.trim())},blur:function(i){t.$forceUpdate()}}})])]),t._v(" "),t.initial?t._e():e("li",[e("div",{staticClass:"g-form-list-l"},[e("label",{on:{click:function(i){t.isDefault=!t.isDefault}}},[e("i",{staticClass:"g-checkbox",class:{checked:t.isDefault}}),t._v(" "),e("span",[t._v(t._s(t.isDefault?"默认地址":"设为默认"))])])])])]),t._v(" "),e("div",{staticClass:"g-btn g-btn-gray mt30",class:{"g-btn-touchable":!t.no},on:{click:t.save}},[t._v("\n    保存地址\n  ")]),t._v(" "),e("picker",{ref:"picker",attrs:{addId:t.id,provinceID:t.provinceID,cityID:t.cityID,countryID:t.countryID},on:{confirm:t.setAddress}})],1)},staticRenderFns:[]}},308:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return t.loaded?e("div",[e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"status"}],staticClass:"g-mask"})]),t._v(" "),e("div",{staticClass:"picker-panel f15 pl15 pr15",attrs:{status:t.status}},[e("div",{staticClass:"picker-hd tc rel"},[t._v("\n      所在地区\n      "),e("i",{staticClass:"g-sheet-close",staticStyle:{right:"0"},on:{click:function(i){t.status=0}}})]),t._v(" "),e("div",{staticClass:"rel g-hair-bottom picker-tab-wrap"},t._l(t.region,function(i,s){return e("div",{staticClass:"picker-tab",class:{"picker-tab-active":t.tabIndex===s},on:{click:function(i){t.tabIndex=s}}},[t._v("\n        "+t._s(i)+"\n      ")])})),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:0===t.tabIndex,expression:"tabIndex === 0"}],staticClass:"picker-option f14",on:{click:function(i){t.select(i,0)}}},t._l(t.province,function(i){return e("li",{key:i.id,class:{"picker-option-checked":i.name===t.provinceName},attrs:{value:i.name}},[t._v("\n        "+t._s(i.name)+"\n        "),e("i",{directives:[{name:"show",rawName:"v-show",value:i.name===t.provinceName,expression:"val.name === provinceName"}],staticClass:"picker-icon-check"})])})),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:1===t.tabIndex,expression:"tabIndex === 1"}],staticClass:"picker-option f14",on:{click:function(i){t.select(i,1)}}},t._l(t.city,function(i){return e("li",{key:i.id,class:{"picker-option-checked":i.name===t.cityName},attrs:{value:i.name}},[t._v("\n        "+t._s(i.name)+"\n        "),e("i",{directives:[{name:"show",rawName:"v-show",value:i.name===t.cityName,expression:"val.name === cityName"}],staticClass:"picker-icon-check"})])})),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:2===t.tabIndex,expression:"tabIndex === 2"}],staticClass:"picker-option f14",on:{click:function(i){t.select(i,2)}}},t._l(t.country,function(i){return e("li",{key:i.id,class:{"picker-option-checked":i.name===t.countryName},attrs:{value:i.name}},[t._v("\n        "+t._s(i.name)+"\n        "),e("i",{directives:[{name:"show",rawName:"v-show",value:i.name===t.countryName,expression:"val.name === countryName"}],staticClass:"picker-icon-check"})])}))])],1):t._e()},staticRenderFns:[]}},324:function(t,i,e){var s=e(194);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(118)("8fc7616e",s,!0)},339:function(t,i,e){var s=e(209);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(118)("a58cebfe",s,!0)},342:function(t,i,e){var s=e(212);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(118)("651c86bc",s,!0)},356:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(25),a=e.n(s);i.default={name:"picker",props:["addId","provinceID","cityID","countryID"],data:function(){return{status:0,tabIndex:0,region:[],province:[],city:[],country:[],provinceName:"",cityName:"",countryName:"",loaded:!1}},mounted:function(){this.init()},methods:{init:function(){var t=this;this.addId?$ajax({url:"/api/ajax/getAreaByPid",data:{address_id:this.addId},success:function(i){if(0===i.code){var e=i.data;t.assign({province:t.obj2Array(e.province),city:t.obj2Array(e.city),country:t.obj2Array(e.country),provinceName:e.province[t.provinceID],cityName:e.city[t.cityID],countryName:e.country[t.countryID]}),t.$emit("confirm",[{id:t.provinceID,name:t.provinceName},{id:t.cityID,name:t.cityName},{id:t.countryID,name:t.countryName}])}}}):$ajax({url:"/api/ajax/getAreaByPid",data:{pid:0},success:function(i){if(0===i.code){var i=i.data;t.assign({province:t.obj2Array(i.province),city:t.obj2Array(i.city),country:t.obj2Array(i.country),provinceName:i.province[i.default_province],cityName:i.city[i.default_city],countryName:""})}}})},assign:function(t){var i,e=this;for(i in t)this.$data[i]=t[i];this.region=[this.provinceName,this.cityName,this.countryName||"请选择"],this.tabIndex=2,setTimeout(function(){e.loaded=!0},0)},select:function(t,i){var e=t.target.getAttribute("value");switch(i){case 0:this.provinceName=e;break;case 1:this.cityName=e;break;case 2:this.countryName=e}},fetchCityOrCountry:function(t,i){$.get("/api/ajax/getAreaByPid",{pid:t},function(t){0===t.code&&i(a()(t.data))})},obj2Array:function(t){var i,e=[];for(i in t)e.push({id:+i,name:t[i]});return a()(e)},findID:function(t,i){for(var e=this.$data[i],s=e.length,a=0;a<s;a++)if(e[a].name===t)return e[a].id}},watch:{provinceName:function(t){var i=this;if(t&&this.loaded){var e=this.findID(t,"province");this.fetchCityOrCountry(e,function(e){i.city=i.obj2Array(e),i.region=[t,"请选择"],i.cityName="",i.countryName="",i.tabIndex=1})}},cityName:function(t){var i=this;if(t&&this.loaded){var e=this.findID(t,"city");this.fetchCityOrCountry(e,function(e){i.country=i.obj2Array(e),i.region=[i.provinceName,t,"请选择"],i.countryName="",i.tabIndex=2})}},countryName:function(t){if(t&&this.loaded){var i=this.provinceName,e=this.cityName;this.region=[i,e,t],this.status=0,this.$emit("confirm",[{id:this.findID(i,"province"),name:i},{id:this.findID(e,"city"),name:e},{id:this.findID(t,"country"),name:t}])}},tabIndex:function(t){if(this.loaded){var i=window.innerWidth/10*8,e=window.innerHeight,s=document.querySelectorAll(".picker-option")[t],a=s.querySelector(".picker-option-checked");a?setTimeout(function(){var t=a.getBoundingClientRect().top;if(t<e-i){var n=e-i-t;s.scrollTop-=n}if(t+50>e){var n=t+50-e;s.scrollTop+=n}},0):setTimeout(function(){s.scrollTop=0})}}}}},367:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(25),a=e.n(s),n=e(277),r=e.n(n);i.default={name:"addressEdit",data:function(){return{id:this.$route.query.id,receiver:USER_DATA.real_name,phone:USER_DATA.phone,region:[],address:"",provinceID:0,cityID:0,countryID:0,isDefault:!1,ok:!1,initial:this.$route.query.initial}},mounted:function(){void 0!==this.$route.query.id&&(this.address=this.$store.state.address,this.provinceID=this.$store.state.provinceID,this.cityID=this.$store.state.cityID,this.countryID=this.$store.state.countryID,this.isDefault=!!this.$store.state.isDefault)},beforeRouteLeave:function(t,i,e){this.ok?e():COMMUNICATOR.$emit("showDialog",{content:"您确认退出此次编辑吗？",type:1,center:!0,callback:function(){e()},cancelCallback:function(){e(!1)}})},methods:{showPicker:function(){this.$refs.picker.status=1},setAddress:function(t){this.region=a()(t)},save:function(){var t=this;if(!this.no){if(!/^1[34578]\d{9}$/.test(this.phone))return COMMUNICATOR.$emit("toast","手机号格式错误");var i={province_id:this.region[0].id,city_id:this.region[1].id,county_id:this.region[2].id,address:this.address};this.initial?i.is_default=1:i.is_default=Number(this.isDefault),this.id&&(i.id=this.id),$ajax({url:"/api/user/saveAdd",type:"post",data:i,success:function(i){0===i.code?(COMMUNICATOR.$emit("toast","已保存"),t.initial&&COMMUNICATOR.$emit("updateAddress"),t.ok=!0,t.$router.back()):COMMUNICATOR.$emit("toast",i.info)}})}},dele:function(){var t=this;this.id&&COMMUNICATOR.$emit("showDialog",{content:"您确认删除该地址吗？",type:1,callback:function(){$ajax({url:"/api/user/delAdd",type:"post",data:{id:t.id},success:function(i){0===i.code?(t.ok=!0,t.$router.back()):COMMUNICATOR.$emit("toast","删除失败，请重试")}})}})}},components:{picker:r.a},computed:{no:function(){return this.region.length<3||this.address.length<5}}}},368:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={name:"address",computed:{list:function(){return this.$store.state.addressList}},mounted:function(){var t=this;this.fetch(function(i){for(var e=0;e<i.length;e++)if(+i[e].is_default)return void t.$store.commit("setAddressID",i[e].id)})},methods:{fetch:function(t){var i=this;$ajax({url:"/api/user/getAddList",success:function(e){0===e.code?(t&&t(e.data),i.$store.commit("setAddressList",e.data)):COMMUNICATOR.$emit("toast",e.info)}})},edit:function(t,i){var e=this.list[t];this.$store.commit("editAddress",{provinceID:e.province_id,cityID:e.city_id,countryID:e.county_id,address:e.address,isDefault:+e.is_default}),this.$router.push({name:"addressEdit",query:{id:i}})},dele:function(t,i){var e=this;COMMUNICATOR.$emit("showDialog",{content:"您确认删除该地址吗？",type:1,center:!0,callback:function(){$ajax({url:"/api/user/delAdd",type:"post",data:{id:i},success:function(i){0===i.code?e.$store.commit("deleteAddress",t):COMMUNICATOR.$emit("toast","删除失败，请重试")}})}})},setDefault:function(t,i){var e=this;1!=this.list[t].is_default&&$ajax({url:"/api/user/setAdd",type:"post",data:{id:i},success:function(i){0===i.code?(COMMUNICATOR.$emit("toast","设置成功"),e.$store.commit("setDefaultAddress",t)):COMMUNICATOR.$emit("toast","设置失败，请重试")}})},select:function(t){this.$route.query.from_order&&(this.$store.commit("setAddressID",t.id),this.$router.replace(this.$route.query.return_url))}}}}});